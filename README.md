# engineer_vision

1.测试设备：

迈德威视MV-SUA630C-T1V-C

2.软件依赖：

1.opencv 4.5.4
2.cmake 3.22
3.ros humble
4.eigen3

3.识别流程：

1.对原始图像乘 0.25 权重，减少计算量。<br>
2.提取对应红色和蓝色通道进行后续运算。<br>
3.对提取单通道的灰度图像进行二值化，适当使用形态学操作或滤波让角点特征更明显（这里使用了两次开运算和一次闭运算）。<br>
4.对二值化图像进行轮廓检测，对轮廓面积大小进行限制，把过小/过大的轮廓筛出去。<br>
5.对轮廓进行多边形拟合，调节拟合精度，最终保证四个角点全部被拟合成三角形，非三角形会被筛除，若最终剩余三角形不等于4,放弃本帧数据；有效距离大概40-80cm（40cm之内相机无法拍到全部角点，80cm之外拟合精确度下降较明显）。<br>
6.对每个拟合三角形中三个顶点排序，排序方法参考了极坐标的定义，使得每个三角形的直角顶点都在顶点数组的第零位。<br>
7.第一帧对四个三角形的顺序进行排序，使得小三角形在第一位，剩下的大三角形按照逆时针往后排列；后续排序跟踪前一帧的排序结果，自动匹配距离最近的点，并增加以下限制：<br>
● 对四个内角进行角度判断，剔除角度大于60度和小于120度的角。<br>
● 如果出现后一帧两个点跟踪了前一帧的同一个点，直接放弃本帧数据，从下一帧重新排序角点。<br>
● 由于角点短暂超出屏幕等原因导致识别断开时重新排序角点。<br>
8.提取四个三角形的直角顶点乘4后（中和前面的0.25）进行pnp运算，采用SOLVEPNP_ITERATIVE进行迭代。<br>